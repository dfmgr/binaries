#!/usr/bin/env bash

# - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
PROG="wallpapermgr"
USER="${SUDO_USER:-${USER}}"
HOME="${USER_HOME:-${HOME}}"

# - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
#set opts

# - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
##@Version       : 020720210125-git
# @Author        : Jason Hempstead
# @Contact       : jason@casjaysdev.com
# @License       : WTFPL
# @ReadME        : wallpapermgr --help
# @Copyright     : Copyright: (c) 2021 Jason Hempstead, CasjaysDev
# @Created       : Sunday, Feb 07, 2021 01:25 EST
# @File          : wallpapermgr
# @Description   : Wallpaper installer and manager
# @TODO          : Refactor Code
# @Other         :
# @Resource      :
# - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
# Import functions
CASJAYSDEVDIR="${CASJAYSDEVDIR:-/usr/local/share/CasjaysDev/scripts}"
SCRIPTSFUNCTDIR="${CASJAYSDEVDIR:-/usr/local/share/CasjaysDev/scripts}/functions"
SCRIPTSFUNCTFILE="${SCRIPTSAPPFUNCTFILE:-testing.bash}"
SCRIPTSFUNCTURL="${SCRIPTSAPPFUNCTURL:-https://github.com/dfmgr/installer/raw/master/functions}"
# - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
if [ -f "$PWD/$SCRIPTSFUNCTFILE" ]; then
  . "$PWD/$SCRIPTSFUNCTFILE"
elif [ -f "$SCRIPTSFUNCTDIR/$SCRIPTSFUNCTFILE" ]; then
  . "$SCRIPTSFUNCTDIR/$SCRIPTSFUNCTFILE"
else
  echo "Can not load the functions file: $SCRIPTSFUNCTDIR/$SCRIPTSFUNCTFILE" 1>&2
  exit 1
fi
# - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
wallpapermgr_install
__options "$@"
# - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
# main program
case "$1" in
*help | -*)
  __help
  ;;

remove)
  shift 1
  PCKLIST=$*
  declare -a LISTARRAY=$PCKLIST
  for wallpaper in ${LISTARRAY[*]}; do
    [ -d "$INSTDIR" ] && rm_rf "$INSTDIR"
    rm_rf "${WALLPAPERS:-$SYSSHARE/wallpapers}/$wallpaper"
  done
  ;;

install | update)
  shift 1
  PCKLIST=$*
  declare -a LISTARRAY=$PCKLIST
  for wallpaper in ${LISTARRAY[*]}; do
    if [[ -d "$WALLPAPERS/$wallpaper" ]]; then
      execute "git -C $WALLPAPERS/$wallpaper pull" "Updating $wallpaper pack"
    else
      execute "git clone $WALLPAPERMGRREPO/$wallpaper $WALLPAPERS/$wallpaper" "Installing $wallpaper pack"
    fi
  done
  ;;

version)
  shift 1
  run_install_version "$@"
  ;;

*)
  __help
  ;;

esac
# - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

# exit
if [ ! -z "$EXIT" ]; then exit "$EXIT"; fi

# end
