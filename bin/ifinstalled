#!/usr/bin/env bash

APPNAME="$(basename $0)"
USER="${SUDO_USER:-${USER}}"

# - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
##@Version     : 010920210727-git
# @Author      : Jason
# @Contact     : casjaysdev@casjay.net
# @File        : ifinstalled
# @Created     : Wed, Aug 05, 2020, 02:00 EST
# @License     : WTFPL
# @Copyright   : Copyright (c) CasjaysDev
# @Description : check if file exists and send notification if it does not
#
# - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
# Import functions
CASJAYSDEVDIR="${CASJAYSDEVDIR:-/usr/local/share/CasjaysDev/scripts}"
SCRIPTSFUNCTDIR="${CASJAYSDEVDIR:-/usr/local/share/CasjaysDev/scripts}/functions"
SCRIPTSFUNCTFILE="${SCRIPTSAPPFUNCTFILE:-testing.bash}"
SCRIPTSFUNCTURL="${SCRIPTSAPPFUNCTURL:-https://github.com/dfmgr/installer/raw/master/functions}"
# - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
if [ -f "$PWD/$SCRIPTSFUNCTFILE" ]; then
  . "$PWD/$SCRIPTSFUNCTFILE"
elif [ -f "$SCRIPTSFUNCTDIR/$SCRIPTSFUNCTFILE" ]; then
  . "$SCRIPTSFUNCTDIR/$SCRIPTSFUNCTFILE"
fi
# - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
systemmgr_install
__options "$@"
# - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

__cmd_exists $1 || printf_exit "$1 is not installed"

notinstalled() {
  notify-send "ðŸ“¦ $1" "must be installed for this function."
  if [ "$(printf "No\\nYes" | dmenu -i -p "Would you like to try to install $1?")" = "Yes" ]; then
    pkmgr silent "$1" | grep -v "error: target not found"
    if [ "$?" -eq 0 ]; then
      notify-send "ðŸ“¦ $1" "has been installed."
    else
      notify-send "ðŸ“¦ $1" "failed to install."
    fi
  fi
}

#command -v "$1" >/dev/null || { notify-send "ðŸ“¦ $1" "must be installed for this function." && exit 1 ;}
if ! cmd_exists "$1"; then
  notinstalled "$1"
  sleep 5
fi

# - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

# end
